Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow | % { $pf=Get-NetFirewallPortFilter -AssociatedNetFirewallRule $_; $af=Get-NetFirewallAddressFilter -AssociatedNetFirewallRule $_; $addr= if($af.RemoteAddress){$af.RemoteAddress -join ','} else {'Any'}; $risk = ($addr -match 'Any|0\.0\.0\.0|::/0') ? 'WIDE' : ($addr -match 'LocalSubnet' ? 'Scoped(LocalSubnet)' : 'Scoped'); [pscustomobject]@{Rule=$_.DisplayName; Profile=$_.Profile; Protocol=$pf.Protocol; LocalPort=($pf.LocalPort -join ','); RemoteAddress=$addr; Risk=$risk} } | ft -auto
